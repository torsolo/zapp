<# esempio 1	#leggo contenuto file	$content = Get-Content -Path 'C:\MYKNOW\QUOTIDIE\MM\psuno.txt'	# sostituisco testo	$newContent = $content -replace 'GRATIAS', 'GRATIAS1'	# scrivo file con altro nome	$newContent | Set-Content -Path 'C:\MYKNOW\QUOTIDIE\MM\psdue.txt'#><# esempio 2# inserisco due righe di testo sotto quella cercata$FileName = 'C:\MYKNOW\QUOTIDIE\MM\psuno.txt'$Patern = "GRATIAS" # the 2 lines will be added just after this pattern $FileOriginal = Get-Content $FileName# create empty Array and use it as a modified file...$FileModified = @() Foreach ($Line in $FileOriginal){        $FileModified += $Line    if ($Line -match $Patern)     {        #Add Lines after the selected pattern         $FileModified += 'SOTTO GRATIAS1'        $FileModified += 'SOTTO GRATIAS2'    } }#Set-Content $fileName $FileModified $FileModified | Set-Content -Path 'C:\MYKNOW\QUOTIDIE\MM\psdue.txt'#><# esempio 3# sposto una riga dopo averla trovata$FileName = 'C:\MYKNOW\QUOTIDIE\MM\psuno.txt'$FileOriginal = Get-Content $FileName# create empty Array and use it as a modified file...$FileModified = @() Foreach ($Line in $FileOriginal){        if ($Line -match '__COMMUNIO__')     {        $Trovata = $Line    } }Foreach ($Line in $FileOriginal){        if ($Line -match 'ComunioneSpirituale')     {        $FileModified += $Trovata + [Environment]::NewLine    }     if ($Line -notmatch '__COMMUNIO__')     {		$FileModified += $Line    } }#Set-Content $fileName $FileModified $FileModified | Set-Content -Path 'C:\MYKNOW\QUOTIDIE\MM\psdue.txt'#># esempio 4# sposto una riga dopo averla trovata# per una lista di files$files = Get-ChildItem 'C:\MYKNOW\QUOTIDIE\V*.txt'foreach ($FileName in $files){	Write-Host $FileName	$FileOriginal = Get-Content $FileName	$FileModified = @() 	# cerco la riga di interesse	Foreach ($Line in $FileOriginal)	{    		if ($Line -match '__COMMUNIO__') 		{			$Trovata = $Line		} 	}	# rileggo e ricarico array delle righe fino alla riga da inserire	Foreach ($Line in $FileOriginal)	{    		if ($Line -match 'ComunioneSpirituale') 		{			$FileModified += $Trovata + [Environment]::NewLine		} 		if ($Line -notmatch '__COMMUNIO__') 		{			$FileModified += $Line		} 	}	#Set-Content $fileName $FileModified 	$FileModified | Set-Content -Path $FileName}Read-Host -Prompt "FATTO!"